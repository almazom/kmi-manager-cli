# KMI Manager CLI UX Review (2026-01-29)

## Expert Bio
I have 30 years of experience designing and auditing developer-facing tools, with a focus on terminal UX, observability workflows, and operational safety. I have led UX programs for incident response and key-management systems where clarity and error recovery directly impact uptime. My work spans CLI command design, help text architecture, and TUI ergonomics under stress. I also coach teams on progressive disclosure, failure-mode messaging, and making operator workflows resilient.

## Scope
- CLI command UX (flags, subcommands, help output)
- Onboarding and documentation flow (README and SDD references)
- Operator ergonomics for proxy, dashboards, trace view, and logs/state

## Findings (ordered by impact)
### High Impact
1) **Dry-run mode defaults to on but is not visible to operators.**
   - `DEFAULT_KMI_DRY_RUN = True` means health and proxy requests can be synthetic, yet the CLI does not surface this in help or output. Operators can easily misread dashboards as live data and make incorrect rotation or incident decisions. Evidence: `src/kmi_manager_cli/config.py`, `src/kmi_manager_cli/health.py`, `src/kmi_manager_cli/proxy.py`.

2) **Onboarding lacks a runnable quickstart and examples, increasing setup failure.**
   - `README.md` only lists paths and points to the SDD, but there is no step-by-step setup, sample `.env`, or `_auths/*.env` example with required fields like `KMI_API_KEY` and `KMI_KEY_LABEL`. This creates high cognitive load for first-run users and makes error recovery slower. Evidence: `README.md`, `src/kmi_manager_cli/keys.py`.

3) **Health command semantics are inconsistent across flags and subcommands.**
   - `--health` shows the current key only, while `kmi health` and `--all` show all keys. This violates user expectations and increases the chance of checking the wrong scope under pressure. Evidence: `src/kmi_manager_cli/cli.py`.

4) **Help text is dense and hard to scan in the terminal.**
   - `APP_HELP` is a single long block that Rich renders as a wrapped paragraph, and it omits critical onboarding clues (current account path, auths dir resolution). The result is low discoverability for key paths and modes. Evidence: `src/kmi_manager_cli/cli.py`, `_resolve_auths_dir` in `src/kmi_manager_cli/config.py`.

### Medium Impact
5) **Proxy auth guidance omits how to supply the token.**
   - Help warns about `KMI_PROXY_TOKEN`, but does not say it can be passed as `Authorization: Bearer <token>` or `x-kmi-proxy-token`, which leads to trial-and-error 401s. Evidence: `src/kmi_manager_cli/cli.py`, `_authorize_request` in `src/kmi_manager_cli/proxy.py`.

6) **No operator-facing command to show resolved config and paths.**
   - There is no `kmi config`/`kmi doctor` output for the resolved auths dir, state dir, dry-run status, or proxy base path. This slows debugging and complicates runbooks. Evidence: `src/kmi_manager_cli/cli.py`.

7) **Dashboards rely heavily on color and emoji with no accessibility fallback.**
   - Rich panels use colored status labels and icons, but there is no `--no-color` / `--plain` mode for monochrome terminals, logging pipelines, or accessibility needs. Evidence: `src/kmi_manager_cli/ui.py`.

### Low Impact / Polish
8) **Trace confidence can read as perfect before any real traffic.**
   - The title displays 100% confidence when there are zero entries, while a smaller caption says “warming up.” This is a small but real trust/interpretation issue. Evidence: `src/kmi_manager_cli/trace.py`, `src/kmi_manager_cli/trace_tui.py`.

9) **Documentation structure is fragmented across `Docs/` and `docs/`.**
   - The split directory structure makes it harder to know where operator docs live and reinforces the lack of a single onboarding path. Evidence: repository tree (`Docs/` vs `docs/`).

## Recommended UX Improvements (prioritized)
- Surface dry-run status prominently: add a banner to health/trace output and include `KMI_DRY_RUN` in `--help`, or flip the default to off for production use.
- Add a short, runnable quickstart in `README.md` with a minimal `.env`, sample `_auths/*.env`, and a “first success” command (`kmi --all` or `kmi health`).
- Unify health semantics: make `kmi health` and `--health` consistent, or rename `--health` to `--current` and keep `--all` as the default health view.
- Reformat help into sections with short bullets; include resolved path hints for `_auths`, `~/.kimi/config.toml`, and `~/.kmi`.
- Document proxy token usage explicitly in help and error messages (Authorization header and `x-kmi-proxy-token`).
- Add an operator-facing `kmi doctor` or `kmi config` command that prints resolved settings and filesystem paths.
- Offer a `--plain`/`--no-color` flag for dashboards and trace output.
