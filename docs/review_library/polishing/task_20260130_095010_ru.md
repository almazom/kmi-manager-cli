# SSOT: Итоги ревью и задачи (30.01.2026)

Ниже короткий, понятный список задач. Сначала самое критичное.

## !!! Критично (сделать первым)
1) Починить глобальный лимитер запросов в прокси и добавить тесты (сейчас логика сломана).
2) Добавить потоковую передачу ответов (streaming) и фильтрацию hop-by-hop заголовков, чтобы не буферить большие ответы и избежать рисков.
3) Улучшить авто-ротацию ключей: учитывать здоровье/квоты, а не только round-robin.
4) Привести в порядок DRY-RUN: либо не трогать сеть, либо явно писать, что health ходит в сеть.

## !! Важно (после критичных)
1) Миграции для `schema_version` + тесты миграций.
2) Убрать дублирование поиска/парсинга ключей (единый хелпер).
3) Улучшить логику retry/cooldown для 429/5xx и ослабить "вечные" предупреждения здоровья.
4) Защита на Windows: блокировки или режим "один процесс" + документация.
5) Улучшить безопасность и надежность trace/log (переполнение очереди, чувствительные данные).
6) Добавить CI (pytest) и тесты для: лимитов, guardrails прокси, streaming, retry/rotation, валидации конфигов.
7) Консолидация документации под `docs/`, обновить флаги/выводы, добавить короткие примеры.
8) Улучшить сообщения об ошибках конфигурации и подсказки при отсутствии ключей.
9) Подумать о фиксации зависимостей (lockfile) для воспроизводимости.
10) Вести "журнал ревью": что проверено, какие команды запускались, какой SHA.

Статус: готово к реализации.
