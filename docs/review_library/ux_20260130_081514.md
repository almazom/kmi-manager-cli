# KMI Manager CLI UX Review (2026-01-30)

## Expert Bio
I have 30 years of experience designing and auditing developer tools with heavy operational load, from CLI runtimes to incident-response consoles. My work emphasizes human factors such as error recovery, progressive disclosure, and time-to-triage under stress. I have led UX programs for API key management and proxy tooling where small mismatches in messaging can cause real downtime. I also coach teams on documentation clarity, help text architecture, and resilient operator workflows.

## Scope
- CLI command UX (flags, subcommands, help output)
- Documentation clarity and onboarding flow (README, .env example, docs layout)
- Error messaging and recovery guidance
- Operational ergonomics for proxy, dashboards, trace view, and local state/logs

## Findings (ordered by impact)
### High Impact
1) **Operational mode can be misread because dry-run is default and not surfaced everywhere.**
   - `DEFAULT_KMI_DRY_RUN = True` means the first-run experience is simulated, yet `kmi status` does not surface mode and the quickstart runs commands that look like production work. This increases the risk of trusting synthetic health data or proxy behavior. Evidence: `src/kmi_manager_cli/config.py`, `src/kmi_manager_cli/cli.py`, `README.md`.

2) **Health scope is inconsistent across flags and commands.**
   - `kmi --health` shows only the current key, while `kmi health` and `kmi --all` show all keys. Under pressure, this difference is easy to miss and can lead to checking the wrong scope. Evidence: `src/kmi_manager_cli/cli.py`.

3) **Auth file support in docs and errors is narrower than the actual implementation.**
   - The error message says to add `*.env` files in `_auths/`, while the loader also supports `.toml`, `.json`, and `~/.kimi/config.toml` is used for current account health. This mismatch creates onboarding churn and makes errors feel misleading. Evidence: `src/kmi_manager_cli/errors.py`, `src/kmi_manager_cli/auth_accounts.py`, `README.md`.

### Medium Impact
4) **Locale and timezones are mixed without user control.**
   - Rotation summaries include Russian text, trace and logs use MSK timestamps, and state timestamps are UTC. Mixed locale/timezone without configuration complicates incident timelines and cross-team handoffs. Evidence: `src/kmi_manager_cli/ui.py`, `src/kmi_manager_cli/trace.py`, `src/kmi_manager_cli/logging.py`, `src/kmi_manager_cli/state.py`.

5) **Proxy auth errors are not actionable for operators.**
   - The 401 response only says "Unauthorized proxy access" and help text does not spell out the accepted header names. This causes trial-and-error when setting up remote access. Evidence: `src/kmi_manager_cli/proxy.py`, `src/kmi_manager_cli/cli.py`.

6) **Dashboards rely on color and emoji without a plain-text mode.**
   - Rich output uses color and symbols, but there is no `--plain` / `--no-color` or `NO_COLOR` support for accessibility and log-friendly usage. Evidence: `src/kmi_manager_cli/ui.py`, `src/kmi_manager_cli/trace_tui.py`.

### Low Impact / Polish
7) **Help text is dense and hard to scan.**
   - `APP_HELP` is a long block of defaults and notes without scannable sections or example workflows, reducing discoverability in the terminal. Evidence: `src/kmi_manager_cli/cli.py`.

8) **Documentation is split across `Docs/` and `docs/`.**
   - Case-sensitive duplication creates navigation friction and dilutes the primary onboarding path. Evidence: repository tree.

## Recommended UX Improvements (prioritized)
- Add a persistent "mode" banner across all commands, including `kmi status`, and consider a `kmi doctor` command that prints resolved config paths and current mode.
- Align health semantics: make `--health` and `kmi health` identical, or rename the flag to `--current` to avoid ambiguity.
- Update README and error text to list all supported auth file formats and explicitly mention `~/.kimi/config.toml` behavior.
- Standardize locale/timezone to local time or provide a configurable timezone/locale setting; keep it consistent across logs, trace, and state.
- Improve proxy auth guidance with explicit header examples in both help text and the 401 response payload.
- Add `--plain` / `--no-color` and honor `NO_COLOR` for accessibility and non-interactive pipelines.
- Reformat `--help` output into short sections with example commands and common workflows.
- Consolidate documentation to a single canonical directory and link to it from the README.
